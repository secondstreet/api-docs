FORMAT: 1A
HOST: https://partners.secondstreet.com/p/api



# Group Creating/Sending a <br>Single Message Campaign
In order to send a ```single_message_campaign```, the following steps must be done. These steps will layout how to create and send a `single_message_campaign` that has `html` as the body of the message.

**Steps**
1. [Create New Message Campaign](#creating-sending-a-br-single-message-campaign-message-campaign-post)
2. [Get Single Message Campaign](#creating-sending-a-br-single-message-campaign-single-message-campaign-get)
3. [Create New Message Campaign Audience](#creating-sending-a-br-single-message-campaign-message-campaign-audience-post)
4. [Create New Message Version](#creating-sending-a-br-single-message-campaign-message-version-post)
5. [Update Single Message Campaign](#creating-sending-a-br-single-message-campaign-single-message-campaign-put)

## Message Campaign [/message_campaigns/{id}]
Message Campaign is the root of any message campaign.  The types of message campaigns are ***Single Email, Newsletter, Birthday,*** and ***Drip***


<h3 id="creating-sending-a-br-single-message-campaign-message-campaign-post">Step 1: Create New Message Campaign</h3>

::: note
## Message Campaign Preset
When posting to create a `message campaign`, be sure to use the following which creates a Single-Email campaign:
```http
message_campaign_preset_id: 1
```
:::
::: warning
#### <i class="fa fa-warning"></i> Caution
If the value of `message_campaign_preset_id` is not `1`, the steps described within will not work properly.
:::

### Create New Message Campaign [POST]

 Attribute | Description
 --:| ----
 message_campaign_preset_id | <table><tr><th>Name</th><th>ID</th></tr><tr><td>Single Email<td>1</td></tr><tr><td>Newsletter<td>2</td></tr><tr><td>Birthday<td>3</td></tr><tr><td>Drip Campaign<td>4</td></tr></table>

+ Request with body (application/json)

    + Header

            Authorization: a1b2c3d4
            X-Api-Key:12345678
            X-Organization-Id:123

    + Body

            {
              "message-campaigns":[
                {
                 "message_campaign_preset_id":1
                }
              ]
            }

+ Response 201

            {
              "message_campaigns": [
                {
                  "embedded_errors": [],
                  "id": "2273",
                  "is_legacy_message": false,
                  "is_setup_complete": false,
                  "message_campaign_type_id": 1,
                  "name": "EdwardsvilleOnline.com's Message Campaign 259",
                  "organization_id": 123,
                  "send_to_existing_audience_members": false,
                  "sending_status_type_id": 0,
                  "status_type_id": 1
                }
              ]
            }


## Single Message Campaign [/single_message_campaigns/{id}]
A Single Message Campaign is the simplist of campaigns.


<h3 id="creating-sending-a-br-single-message-campaign-single-message-campaign-get">Step 2: Get Single Message Campaign</h3>

<div class="action"><h4 class="action-heading"><div class="name"></div><a href="#creating-sending-a-br-single-message-campaign-single-message-campaign-get" class="method get">GET</a><code class="uri">/single_message_campaigns/{id}</code></h4></div>

In our GET example below, the `id` URI Parameter value of `2273` (the Id of the `message campaign`) was the `id` returned from [Step 1](#creating-sending-a-br-single-message-campaign-message-campaign-post).

::: note
## The RESPONSE
Two attributes from the GET below whose values will be used in later calls:
```http
id: 2273
message_id: 2467
```
:::

### Get Single Message Campaign [GET]
By default, when a message campaign is created with a `message_campaign_preset_id` value of `1`, a single message campaign is created.

+ Parameter

    + id: `2273` (required, integer) - The single message campaign ID

+ Response 201 

    + Body

            {
               "single_message_campaigns":[
                  {
                     "embedded_errors":[

                     ],
                     "id":2273,
                     "is_scheduled":false,
                     "message_campaign_type_id":1,
                     "message_communication_medium_type_id":1,
                     "message_id":2467,
                     "message_is_approval_required":false,
                     "message_sending_status_type_id":0,
                     "message_test_percentage":0,
                     "message_test_winning_criteria_id":(0),
                     "message_versions":[

                     ],
                     "name":"EdwardsvilleOnline.com's Message Campaign 256",
                     "organization_id":123,
                     "status_type_id":1
                  }
               ],
               "meta":{
                  "embedded_errors":[

                  ],
                  "page_index":1,
                  "page_size":1000,
                  "total_records":1
               }
            }


## Message Campaign Audience [/message_campaign_audiences{?messageCampaignId}]
The `message_campaign_audience` is used to determine who should receive the message campaign.


<h3 id="creating-sending-a-br-single-message-campaign-message-campaign-audience-post">Step 3: Create New Message Campaign Audience</h3>

::: note
The `message_campaign_id` is obtained from the RESPONSE of the `message_campaign` POST.  The `audience_id` would have already been acquired.
:::

### Create New Message Campaign Audience [POST]
Associates an audience to the message campaign.

Associating a `message_campaign_audience` to a `message_campaign` require the following:

Attribute | Description
--:| ----
 `is_excluded` | If `true`, the campaign will *NOT* be sent to those in the audience
 `message_campaign_id` | The `id` of the `message_campaign`
 `audience_id` | The `id` of a prexisting audience


<!-- + Parameters

    + messageCampaignId: `12345` (required, integer) - The message campaign ID from the post message_campaign response. -->


+ Request with body (application/json)
    
    + Header

            Authorization: a1b2c3d4
            X-Api-Key:12345678
            X-Organization-Id:123

    + Body

            {
               "message-campaign-audiences":[
                  {
                     "is_excluded":false,
                     "message_campaign_id":2273,
                     "audience_id":"409"
                  }
               ]
            }

+ Response 201

            {
               "message_campaign_audiences":[
                  {
                     "audience_id":409,
                     "embedded_errors":[

                     ],
                     "id":2782,
                     "is_excluded":false,
                     "message_campaign_id":2273
                  }
               ]
            }


## Message Version [/message_versions/{id}]


<h3 id="creating-sending-a-br-single-message-campaign-message-version-post">Step 4: Create New Message Version</h3>

This step is where the actual email is created.

### Create New Message Version [POST]
Create a new message version.

Attribute | Description | Example
--:| ----|-----
subject|The subject of the email|"Email Subject"
reply_to|The email address that will serve as the reply to email address|"noreply@secondstreet.com"
from_name|The name that is displayed in the from field|"No Reply"
body|This is the body of your message campaign. URL encoded? The body must contain the opt out token {{{System.OptOutText}}}|"\ntest\n\n{{{System.OptOutText}}}"
plain_text_body|This is the body of your message campaign that users will see if they view email in plain text |This is plain.
body_source_type_id|<table><tr><th>Name</th><th>ID</th></tr><tr><td>Template<td>1</td></tr><tr><td>Scrape Url<td>2</td></tr><tr><td>Html<td>3</td></tr></table>|1
body_scrape_url|The url if the message body type is scrape|"http://secondstreet.com/"
status_type_id|<table><tr><th>Name</th><th>ID</th></tr><tr><td>Active<td>1</td></tr><tr><td>InActive<td>2</td></tr><tr><td>Deleted<td>3</td></tr><tr><td>Submitted<td>4</td></tr><tr><td>Hidden<td>5</td></tr><tr><td>Rejected<td>6</td></tr><tr><td>Cancelled<td>7</td></tr></table>|1
sender_account_id|The id of a sender account for your organization|785
single_message_campaign_id|The id of the single message campaign|2273
message_id|The id of the message campaign|2467
message_body_template_id|The id of the template being used for the body if `body_source_type_id` has a value of `1`|1

+ Request with body (application/json)
    + Header

            Authorization: a1b2c3d4
            X-Api-Key:12345678
            X-Organization-Id:123

    + Body

            {
               "message-versions":[
                  {
                     "subject":"Email Subject",
                     "reply_to":"noreply@secondstreet.com",
                     "from_name":"No Reply",
                     "body":"\ntest\n\n{{{System.OptOutText}}}",
                     "plain_text_body":null,
                     "body_source_type_id":3,
                     "body_scrape_url":null,
                     "status_type_id":null,
                     "sender_account_id":"1",
                     "single_message_campaign_id":"2273",
                     "message_id":null,
                     "message_body_template_id":"1"
                  }
               ]
            }

+ Response 201

            {
               "message_versions":[
                  {
                     "body_source_type_id":3,
                     "embedded_errors":[

                     ],
                     "from_name":"No Reply",
                     "id":2647,
                     "message_body_template_id":1,
                     "message_id":2467,
                     "reply_to":"noreply@secondstreet.com",
                     "sender_account_id":1,
                     "single_message_campaign_id":2273,
                     "status_type_id":1,
                     "subject":"Subject Line Text"
                  }
               ]
            }


## Single Message Campaign [/single_message_campaigns/{id}]
A Single Message Campaign is the simplist of campaigns.


<h3 id="creating-sending-a-br-single-message-campaign-single-message-campaign-put">Step 5: Update Single Message Campaign</h3>

This step is where the email is scheduled and saved as ready to send.  For a `single_message_campaign` the `message_campaign_type_id` will always be `1` and `schedule_type_id` and `message_sending_status_type_id` will also be `1`.  `is_scheduled` will also be set to TRUE.

### Update Single Message Campaign [PUT]

| Attribute                                 |            Description           | Example                    |
|--------------------------------------|----------------------------------|--------------------------|
| organization_id                      | The id of the organization       | 123                      |
| name                                 | The name of the message campaign | "API DOC CAMPAIGN"         |
| message_campaign_type_id             | <table><tr><th>Name</th><th>ID</th></tr><tr><td>SingleEmail<td>1</td></tr><tr><td>SingleSMS<td>2</td></tr><tr><td>DripCampaign<td>3</td></tr><tr><td>Newsletter<td>4</td></tr><tr><td>Birthday<td>5</td></tr></table>                             | 1                        |
| status_type_id                       | <table><tr><th>Name</th><th>ID</th></tr><tr><td>Active<td>1</td></tr><tr><td>InActive<td>2</td></tr><tr><td>Deleted<td>3</td></tr><tr><td>Submitted<td>4</td></tr><tr><td>Hidden<td>5</td></tr><tr><td>Rejected<td>6</td></tr><tr><td>Cancelled<td>7</td></tr></table>                             | 1                        |
| schedule_type_id                     | <table><tr><th>Name</th><th>ID</th></tr><tr><td>SpecificDateTime<td>1</td></tr><tr><td>Recurring<td>2</td></tr><tr><td>BirthdayEvent<td>3</td></tr><tr><td>JoinedAudienceEvent<td>4</td></tr><tr><td>RelatedMessageSent<td>5</td></tr></table>                             | 1                        |
| schedule_delay_datepart_type_id      | <table><tr><th>Name</th><th>ID</th></tr><tr><td>EverySecond<td>1</td></tr><tr><td>EveryMinute<td>2</td></tr><tr><td>Hourly<td>3</td></tr><tr><td>Daily<td>4</td></tr><tr><td>Weekly<td>5</td></tr><tr><td>Monthly<td>6</td></tr><tr><td>Yearly<td>7</td></tr></table>                              | 1           |
| schedule_delay_value                 | How long will this message be delayed before sending | 0           |
| schedule_recurring_pattern<div class="warning"><i class="fa fa-warning" style="color:red"></i> Validates only if `schedule_type_id` is `2`</div>| <table><tr><th>Name</th><th>Desc</th></tr><tr><td>Daily<td>no pattern</td></tr><tr><td>Weekly<td>Days of the Week using three letter abbreviations that are comma delimited. Example: `MON,WED,FRI`</td></tr><tr><td>Monthly<td>Eitherâ€¦<br><ul><li>just a number for a specific date of the month. (example: 10 for the 10th of each month)</li><li>a number then day of week abbreviation for a specific weekday of the month.(example: `2THU` for the second Thursday of the month).</li></ul></td></tr><tr><td>Yearly<td>Either....<ul><li>Month 3 letter abbreviation followed by day of the month (example: `FEB15`)</li><li>A number then day of week abbreviation followed by the month abrreviation for a specific weekday of a specific month. (example: `2THUJUN` for the second Thursday of June).</li></ul></td></tr></table>                             |                          |
| schedule_start_date                  | The time when the campaign should be sent | 2016-06-22T05:00:00.000Z |
| schedule_end_date                    | The time when the campaign should be stop sending | 2017-01-01T00:01:00.000Z |
| schedule_start_time                  | Relevant on event based campaigns where the date is not certain. | (empty Object)           |
| is_scheduled                         | If the campaign has a schedule   | TRUE                     |
| send_now                             | Tells the api you want to send a message immediately instead of using the schedule_start_date. Only works for messages that would normally have a schedule_start_date. | TRUE |
| schedule_number_of_recurrences       | Number of times the campaign should go out to an indvidual.  Only relevant to drip and newsletter.  | 2           |
| message_id                           | The ID of the message            | 2467                     |
| message_communication_medium_type_id | <table><tr><th>Name</th><th>ID</th></tr><tr><td>Email<td>1</td></tr><tr><td>SMS<td>2</td></tr><tr><td>MMS<td>3</td></tr><tr><td>Facebook Post<td>4</td></tr><tr><td>Instagram Post<td>5</td></tr></table> | 1                        |
| message_sending_status_type_id       | <table><tr><th>Name</th><th>ID</th></tr><tr><td>Incomplete<td>0</td></tr><tr><td>Scheduled<td>1</td></tr><tr><td>SentAndScheduled<td>2</td></tr><tr><td>TestSend<td>3</td></tr><tr><td>Sending<td>4</td></tr><tr><td>Sent<td>5</td></tr></table>                          | 0                        |
| message_test_percentage              | The percentage of email to be used in A/B testing. Only applicable with multiple versions.  | 0                        |
| message_test_winning_criteria_id     | <table><tr><th>Type</th><th>ID</th></tr><tr><td>OpenRate<td>1</td></tr><tr><td>ClickThroughRate<td>2</td></tr></table>                             | 0                        |
| message_is_approval_required         | The option to have approval on a message before it can be sent.                             | FALSE                    |
| message_campaign_category_id         | The category id that the campaign is associated with.                             | 36                    |

+ Request with body (application/json)
    + Headers
        Authorization: a1b2c3d4
        X-Api-Key:12345678
        X-Organization-Id:123

    + Body
            {
              "single-message-campaigns": [
                {
                  "organization_id": 123,
                  "name": "API DOC CAMPAIGN",
                  "message_campaign_type_id": 1,
                  "status_type_id": 1,
                  "schedule_description": null,
                  "total_recipients_count": null,
                  "additional_recipients": null,
                  "external_id": null,
                  "schedule_type_id": 1,
                  "schedule_delay_datepart_type_id": null,
                  "schedule_delay_value": null,
                  "schedule_recurring_pattern": "",
                  "schedule_start_date": "2016-06-22T05:00:00.000Z",
                  "schedule_end_date": null,
                  "schedule_start_time": null,
                  "is_scheduled": true,
                  "send_now": true,
                  "schedule_number_of_recurrences": null,
                  "message_id": 2467,
                  "message_communication_medium_type_id": 1,
                  "message_sending_status_type_id": 1,
                  "message_test_percentage": 0,
                  "message_test_winning_criteria_id": 0,
                  "message_test_duration_open_count": null,
                  "message_test_duration_minutes": null,
                  "message_is_approval_required": false,
                  "message_campaign_category_id": "36"
                }
              ]
            }

+ Response 201

            {
               "single_message_campaign":[
                  {
                     "embedded_errors":[

                     ],
                     "id":2273,
                     "is_scheduled":true,
                     "message_campaign_category_id":36,
                     "message_campaign_type_id":1,
                     "message_communication_medium_type_id":1,
                     "message_id":2467,
                     "message_is_approval_required":false,
                     "message_sending_status_type_id":0,
                     "message_test_percentage":0,
                     "message_test_winning_criteria_id":0,
                     "message_versions":[
                        {
                           "body":"\ntest\n\n{{{System.OptOutText}}}",
                           "body_source_type_id":3,
                           "embedded_errors":[

                           ],
                           "from_name":"No Reply",
                           "id":2657,
                           "message_body_template_id":1,
                           "message_id":2467,
                           "reply_to":"noreply@secondstreet.com",
                           "sender_account_id":1,
                           "single_message_campaign_id":2273,
                           "status_type_id":1,
                           "subject":"Email Subject"
                        }
                     ],
                     "name":"apidoctestagain",
                     "organization_id":123,
                     "schedule_id":1531,
                     "schedule_recurring_pattern":"",
                     "schedule_start_date":"2016-06-22T05:00:00",
                     "schedule_type_id":1,
                     "status_type_id":1
                  }
               ]
            }

